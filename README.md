# 设备激活码生成器

## 概述

这是一个用于生成设备激活码的Python程序。该程序接收设备ID作为输入，通过多层加密算法生成对应的激活码。

## 功能特性

- **多层加密算法**：结合位运算、XOR加密和块反转
- **可配置密钥**：默认使用"SAY"作为加密密钥
- **十六进制输出**：生成的激活码以大写十六进制格式输出
- **交互式输入**：通过命令行交互获取设备ID
- **输入验证**：检查设备ID是否为空和类型是否正确
- **错误处理**：完善的异常处理和用户友好的错误提示
- **键盘中断支持**：优雅处理Ctrl+C中断操作

## 加密算法详解

### 1. 密钥处理
- 计算密钥字符的ASCII值总和
- 根据总和模7加1的结果确定位移位数（1-7位）
- 将密钥转换为字节数组用于XOR操作

### 2. 位运算加密
- 对每个字节进行循环右移操作
- 位移位数由密钥计算得出
- 使用位运算确保数据完整性

### 3. XOR加密
- 使用密钥字节数组对位移后的数据进行XOR操作
- 密钥循环使用以覆盖所有数据

### 4. 块填充和反转
- 根据密钥长度确定块大小
- 添加PKCS#7风格的填充
- 将数据分割成块并反转每个块内的字节顺序
- 连接所有反转后的块

## 环境要求

- Python 3.6 或更高版本
- 无需额外安装第三方库（仅使用Python标准库）

## 安装和运行

### 1. 确保Python环境
```bash
python --version
```

### 2. 运行程序
```bash
python main.py
```

### 3. 如果遇到权限问题，可以使用pip安装到虚拟环境
```bash
# 创建虚拟环境（可选）
python -m venv venv

# 激活虚拟环境
# Windows:
venv\Scripts\activate
# Linux/Mac:
source venv/bin/activate

# 运行程序
python main.py
```

### 输入示例
```
请输入设备ID: ABC123
激活码: 4A2B3C1D5E6F7890
```

## 代码结构

### 主要函数

#### `encrypt(plaintext, key="SAY")`
- **参数**：
  - `plaintext`：要加密的明文（设备ID）
  - `key`：加密密钥（默认为"SAY"）
- **返回值**：加密后的十六进制字符串
- **功能**：执行完整的加密流程
- **异常处理**：包含输入验证和错误处理

#### `main()`
- **功能**：主程序入口，处理用户交互
- **特性**：
  - 输入验证（检查空输入）
  - 键盘中断处理（Ctrl+C）
  - 友好的错误提示

### 加密流程
1. **计算位移位数**：`shift_bits = sum(ord(c) for c in key) % 7 + 1`
2. **准备XOR密钥**：`xor_keys = key.encode()`
3. **确定块大小**：`block_size = max(1, len(key))`
4. **执行位运算**：循环右移每个字节
5. **XOR加密**：使用密钥对数据进行XOR操作
6. **块填充**：添加填充字节
7. **块反转**：反转每个块内的字节顺序
8. **格式化输出**：转换为大写十六进制字符串

## 技术细节

### 位运算实现
```python
shifted = bytes((b >> shift_bits) | ((b << (8 - shift_bits)) & 0xFF) 
              for b in plaintext.encode())
```

### XOR加密实现
```python
xored = bytes(b ^ xor_keys[i % len(xor_keys)] for i, b in enumerate(shifted))
```

### 块处理实现
```python
blocks = [padded[i:i+block_size] for i in range(0, len(padded), block_size)]
reversed_blocks = b"".join(block[::-1] for block in blocks)
```

## 安全特性

- **密钥依赖**：加密强度依赖于密钥的复杂性和长度
- **多层加密**：结合位运算、XOR和块操作提供多层保护
- **不可逆性**：没有提供解密函数，确保激活码的单向性
- **唯一性**：相同设备ID和密钥总是生成相同的激活码

## 注意事项

1. **Python环境**：确保已安装Python 3.6或更高版本
2. **依赖管理**：此程序仅使用Python标准库，无需安装额外包
3. **输入要求**：设备ID不能为空，程序会自动验证输入
4. **密钥安全**：请妥善保管加密密钥，避免泄露
5. **设备ID格式**：程序接受任意字符串作为设备ID
6. **输出格式**：激活码始终为大写十六进制格式
7. **虚拟环境**：建议在虚拟环境中运行以避免系统污染
8. **错误处理**：程序包含完善的错误处理，会显示友好的中文错误信息

## 扩展建议

- 支持自定义密钥长度和复杂度
- 实现解密功能（如需要）
- 添加批量处理功能
- 集成到更大的系统中
- 添加配置文件支持
- 实现日志记录功能
- 添加单元测试

## 许可证

此代码仅供学习和研究使用。
